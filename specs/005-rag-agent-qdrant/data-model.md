# Data Model: RAG Agent

**Feature**: `005-rag-agent-qdrant`

This document defines the key data structures used within the RAG agent. These are conceptual models and will be implemented as Python dataclasses or simple classes in `agent.py`.

## 1. Query

-   **Description**: Represents a user's question submitted to the agent via the CLI.
-   **Fields**:
    -   `text` (str): The raw text of the user's question.
    -   `scope` (Optional[str]): An optional identifier (e.g., chapter name or URL) to limit the search scope. *(Note: Scope-based filtering is a future enhancement and not in the initial plan's single-file implementation.)*

## 2. RetrievedChunk

-   **Description**: Represents a single chunk of text retrieved from the Qdrant vector store that is relevant to the user's query. This corresponds to the payload of a point in Qdrant.
-   **Fields**:
    -   `id` (str): The unique identifier of the point in Qdrant.
    -   `score` (float): The similarity score of the chunk to the query vector.
    -   `text` (str): The actual content of the text chunk.
    -   `url` (str): The source URL from which the chunk was extracted.
    -   `title` (str): The title of the source page.
    -   `section` (str): The specific section within the page (if available).
    -   `chunk_index` (int): The index of the chunk within its original document.

## 3. Answer

-   **Description**: The final response generated by the AI agent.
-   **Fields**:
    -   `response_text` (str): The textual answer generated by the language model.
    -   `source_chunks` (List[RetrievedChunk]): A list of the `RetrievedChunk` objects that were provided to the model as context for generating the answer. This is crucial for verifying grounding.
    -   `is_fallback` (bool): A flag indicating if the response is a "not found" fallback message.
